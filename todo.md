# AITuber実装TODO

## ドキュメント更新
- [ ] APIドキュメントの更新
  - 各サービスのインターフェース説明
  - 設定パラメータの説明
  - エラーコードとハンドリングの説明
- [ ] アーキテクチャドキュメントの作成
  - システム構成の説明
  - 依存関係の図示
  - データフローの説明

## 会話管理システム
- [ ] 会話履歴の永続化機能
  - データ形式の設計
  - 保存先の設定
  - 保存・読み込み処理の実装
  - エラーハンドリング

## キャラクター管理
- [ ] キャラクター情報の型定義
  - ペルソナ情報の詳細な型定義
  - パーソナリティ特性の型定義
  - 興味・関心の型定義
  - バリデーションルールの追加

## メモリシステム
- [ ] メモリシステムとの連携強化
  - 記憶の重要度スコアリング
  - 長期・短期記憶の区別
  - 記憶の有効期限管理
  - コンテキストに応じた記憶の取得最適化

## 感情システム
- [ ] 感情システムの設計と実装
  - 感情パラメータの定義
  - 感情状態の遷移ロジック
  - 感情に基づく応答生成の調整
  - 感情の永続化と履歴管理
  - 感情表現のバリエーション実装

## 音声機能
- [x] 音声合成システムの統合
  - [x] 音声合成エンジン（Voicevox）の選定と実装
  - [ ] 感情に応じた音声パラメータの調整
  - [ ] リアルタイム音声生成の最適化
  - [ ] 音声キャッシュシステムの実装
- [ ] 音声認識システムの統合
  - 音声認識エンジンの選定と実装
  - ノイズ処理と音声品質の最適化
  - リアルタイム音声認識の実装
  - 認識精度の向上とエラー処理

## パフォーマンスと安定性
- [ ] 音声処理の最適化
  - レイテンシの最小化
  - CPU/メモリ使用量の最適化
  - エラー時の自動リカバリ
  - 音声品質とパフォーマンスのバランス調整

## TTS最適化タスク
- [ ] TTSモジュールの最適化
  - 現状は全モデルを一度にロードするが、style_idごとに初回呼び出し時のみロードする仕組みに変更
  - キャッシュ管理の実装（メモリ使用量の制限など）
  - 使用頻度の低いモデルのアンロード機構

## Voicevox連携TTS機能 実装タスク

4. [x] APIの実装
    - `src/aituber/api/api.py`
      - [x] FastAPIでエンドポイントを1つ用意
      - [x] リクエストパラメータでテキスト/音声切り替え
      - [x] character_idでキャラクターYAMLを読み込み

5. [x] CLIの実装
    - `src/aituber/interface/cli.py`（`main.py`をリネーム）
      - [x] typerでコマンド実装
      - [x] `--response-type`でテキスト/音声切り替え
      - [x] `--character-id`でキャラクター指定

6. [x] LLMとの連携
    - [x] APIにおいてダミー応答ではなく実際のLLM応答を返却
    - [x] CLIでもLLM応答を利用
    - [x] 会話コンテキストの維持

---

### 設計メモ

- キャラクターごとのVoicevoxパラメータはYAMLで管理し、現状はstyle_idのみ必須
- 今後、話速・音高などのパラメータも拡張可能
- API/CLIともに1ファイルでテキスト/音声切り替えに対応 