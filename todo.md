# AITuber実装TODO

## ドキュメント更新
- [ ] APIドキュメントの更新
  - 各サービスのインターフェース説明
  - 設定パラメータの説明
  - エラーコードとハンドリングの説明
- [ ] アーキテクチャドキュメントの作成
  - システム構成の説明
  - 依存関係の図示
  - データフローの説明

## 会話管理システム
- [ ] 会話履歴の永続化機能
  - データ形式の設計
  - 保存先の設定
  - 保存・読み込み処理の実装
  - エラーハンドリング

## キャラクター管理
- [ ] キャラクター情報の型定義
  - ペルソナ情報の詳細な型定義
  - パーソナリティ特性の型定義
  - 興味・関心の型定義
  - バリデーションルールの追加

## メモリシステム
- [ ] メモリシステムとの連携強化
  - 記憶の重要度スコアリング
  - 長期・短期記憶の区別
  - 記憶の有効期限管理
  - コンテキストに応じた記憶の取得最適化

## 感情システム
- [ ] 感情システムの設計と実装
  - 感情パラメータの定義
  - 感情状態の遷移ロジック
  - 感情に基づく応答生成の調整
  - 感情の永続化と履歴管理
  - 感情表現のバリエーション実装

## 音声機能
- [ ] 音声合成システムの統合
  - 音声合成エンジンの選定と実装
  - 感情に応じた音声パラメータの調整
  - リアルタイム音声生成の最適化
  - 音声キャッシュシステムの実装
- [ ] 音声認識システムの統合
  - 音声認識エンジンの選定と実装
  - ノイズ処理と音声品質の最適化
  - リアルタイム音声認識の実装
  - 認識精度の向上とエラー処理

## パフォーマンスと安定性
- [ ] 音声処理の最適化
  - レイテンシの最小化
  - CPU/メモリ使用量の最適化
  - エラー時の自動リカバリ
  - 音声品質とパフォーマンスのバランス調整

## Voicevox連携TTS機能 実装タスク

1. キャラクターYAMLのサンプル作成
    - `data/characters/{character_id}.yaml`にstyle_idを含むサンプルを作成

2. キャラクターモデルの拡張
    - `src/aituber/core/models/character.py`
      - Voicevox用style_idをPydanticモデルに追加
      - YAMLからの読み込み対応

3. TTSサービスの実装
    - `src/aituber/core/services/tts_service.py`
      - style_idを利用してVoicevoxで音声合成
      - `synthesize(text: str, character: Character) -> bytes`メソッド

4. APIの実装
    - `src/aituber/api/api.py`
      - FastAPIでエンドポイントを1つ用意
      - リクエストパラメータでテキスト/音声切り替え
      - character_idでキャラクターYAMLを読み込み

5. CLIの実装
    - `src/aituber/interface/cli.py`（`main.py`をリネーム）
      - typerでコマンド実装
      - `--response-type`でテキスト/音声切り替え
      - `--character-id`でキャラクター指定

---

### 設計メモ

- キャラクターごとのVoicevoxパラメータはYAMLで管理し、現状はstyle_idのみ必須
- 今後、話速・音高などのパラメータも拡張可能
- API/CLIともに1ファイルでテキスト/音声切り替えに対応 